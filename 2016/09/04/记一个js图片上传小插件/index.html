<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><title>记一个js图片上传小插件 | 聂明照的博客</title><link rel="shortcut icon" href="/images/favicon.jpg"><link rel="alternate" href="/atom.xml" title="聂明照的博客"><meta name="description" content="最近在做的项目中需要一个图片上传的小控件,由于用的功能不多,索性自己写一个得了."><meta name="keywords" content="前端"><meta property="og:type" content="article"><meta property="og:title" content="记一个js图片上传小插件"><meta property="og:url" content="http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/index.html"><meta property="og:site_name" content="聂明照的博客"><meta property="og:description" content="最近在做的项目中需要一个图片上传的小控件,由于用的功能不多,索性自己写一个得了."><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2019-06-17T08:16:25.478Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="记一个js图片上传小插件"><meta name="twitter:description" content="最近在做的项目中需要一个图片上传的小控件,由于用的功能不多,索性自己写一个得了."><meta name="format-detection" content="telephone=no,email=no"><meta name="theme-color" content="#9C27B0"><meta name="description" content="最近在做的项目中需要一个图片上传的小控件,由于用的功能不多,索性自己写一个得了."><meta name="keywords" content=",前端"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="聂明照的博客"><meta name="msapplication-starturl" content="http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/"><meta name="msapplication-navbutton-color" content="#9C27B0"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="聂明照的博客"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/favicon.jpg"><meta property="article:published_time" content="Sun Sep 04 2016 08:39:00 GMT+0800"><meta property="article:modified_time" content="Mon Jun 17 2019 16:16:25 GMT+0800"><link rel="canonical" href="http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/"><meta name="google-site-verification" content="fXjtlIfaDc_X-0P11rO3bEp1Nk4IKXphoJv0GqGZCco"><meta name="baidu-site-verification" content="I3t1wfwZvd"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-139531378-1","auto"),ga("send","pageview")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?1054d51c0b66f1d168829173682c8159";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/css/mdui.css"><link rel="stylesheet" href="/css/style.css"></head><body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-brown mdui-theme-accent-blue"><script>var a=localStorage.getItem("mdui-theme-layout-dark");a&&(document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark")</script><header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset"><div class="mdui-toolbar mdui-color-theme"><a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a> <a href="/" class="mdui-typo-headline">聂明照的博客</a><div class="mdui-toolbar-spacer"></div><a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a> <a href="/atom.xml" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'RSS'}"><i class="mdui-icon material-icons">rss_feed</i></a></div></header><div class="mdui-dialog" id="search"><div class="search-form"><input type="search" class="search-form-input" placeholder="请输入关键字"></div><div class="search-result" data-resource="/search.xml"></div></div><aside id="sidebar" class="mdui-drawer mdui-drawer-full-height"><div class="mdui-grid-tile"><img src="/images/banner.jpg" style="height:160px"> <img src="/images/avatar.jpg" class="avatar-animation" style="position:absolute;top:10%;left:24px;width:64px;height:64px;border:2px solid #fff;border-radius:50%"><div class="mdui-grid-tile-actions"><div class="mdui-grid-tile-text"><div class="mdui-grid-tile-title">聂明照</div><div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i>桃李不言，下自成蹊</div></div><div class="mdui-grid-tile-buttons"><a href="mailto:1432440963@qq.com" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '1432440963@qq.com'}"><i class="mdui-icon material-icons">email</i></a></div></div></div><div class="mdui-list" mdui-collapse="{accordion: true}"><a href="/" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i><div class="mdui-list-item-content">主页</div></a><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i><div class="mdui-list-item-content">归档</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/07/">七月 2019<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/06/">六月 2019<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="mdui-ripple sidebar_archives-count">3</span></a></div></div><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i><div class="mdui-list-item-content">分类</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/categories/技术/">技术<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/文粹/">文粹<span class="mdui-ripple sidebar_archives-count">2</span></a></div></div><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i><div class="mdui-list-item-content">标签</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/tags/Git/">Git<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/Hexo/">Hexo<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/Java/">Java<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/Markdown/">Markdown<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/前端/">前端<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/古文/">古文<span class="mdui-ripple sidebar_archives-count">2</span></a></div></div><a href="/about" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i><div class="mdui-list-item-content">关于</div></a></div><div class="mdui-divider"></div><div class="mdui-list" mdui-collapse="{accordion: true}"><a href="/tagcloud" class="mdui-list-item mdui-ripple">标签云</a> <a href="/gallery" class="mdui-list-item mdui-ripple">画廊</a><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><div class="mdui-list-item-content">友情链接</div><i class="mdui-list-item-icon mdui-icon material-icons">link</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a href="http://images.niemingzhao.top/my_resume.html" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content:center">我的简历</a></div></div></div></aside><main id="main" class="mdui-m-t-5 fadeIn animated"><link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css"><style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style><article class="mdui-card mdui-m-b-5"><header class="mdui-card-media"><img src="/images/random/material-8.png" style="max-height:240px"><div class="mdui-card-media-covered"><div class="mdui-card-primary"><div class="mdui-card-primary-title">记一个js图片上传小插件</div><div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2016-09-04 / <i class="iconfont">&#xe601;</i> 程小刚 &nbsp;&nbsp; <span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_page_pv"></span></span></div></div></div><div class="mdui-card-menu"><button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button><ul class="mdui-menu" id="qrcode"><li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">发送到手机</a></li><li class="mdui-menu-item" disabled><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC2UlEQVR42u3aW3LbMBAEQN//0skBHMkzC6hCA80vFy2R23BVNvv4+nPl9YWNjY2NjY2NjY39SPZXfH3//D8e/e2Tr97y/vPJt/KYsbGxsW9g//BPfxBQcjSz0N8/p4gZGxsb+wJ2kmai//QvkPJ02MaMjY2Njb3rmNr0ho2NjY39CfasbEiemZc62NjY2NizBk3S0M9LlOQIkvd+vJeGjY2N/Xh2O+h9ws//Yb6NjY2N/Uh2vcI4SkLJos+u4cTLyLGxsbEPZb8PZX1s8H4w0A4SVtZ6sLGxsU9lt6PWtqnUPmfXEk+Rt7GxsbF/OTthtOs1eaBJikpii1Y5sbGxsQ9lz0qFJIj8+Nqjb9MqNjY29g3svACY3WnbUm2yHA56sbGxsQ9i5wexLYhNxUZShGBjY2Ofzd47jl1Z1pwVMEUTChsbG/tQ9q7klC9c5ouYeUkTPRkbGxv7GnabHtolyJVVnnwsUScwbGxs7KPZefspL1qSO/ky0EcSGDY2NvavZbfh5guaydG0w4N8SICNjY19NnuWMJIgkiNbaWzlx4qNjY19AztfnZmt9eSkvPgp/jDY2NjYF7D3Lt98IuGtHAE2Njb22exdzfo26KS5n7/xhyIHGxsb+2h2PjRtBwNtiCvD4HrQi42NjX0oO2e0LaeV9cq8mNncS8PGxsZ+PLtt0M8OZVZyrIwlsLGxse9h502l/E4bep2K4vIDGxsb+2b2Orht8efpMy9OsLGxsW9gJ4XBrEHfNp7aRJi/BRsbG/tsdnvtat/PkuXKkAAbGxv7VPZKKmpLi/UxcHug2NjY2PewZy2hlXQyw6yMCrCxsbFvYLdD2aREye/nB7Gtl4aNjY19JTtBtr9tR8L5SAMbGxsbO2G335ot/eRj6ZffxcbGxr6APUsqOSkfQrQDjOGgFxsbG/sgdvvodiTQtqISfF2oYGNjYx/KvufCxsbGxsbGxsbGfsz1F+jGC20x8P8gAAAAAElFTkSuQmCC"></li></ul><button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button><ul class="mdui-menu" id="share_menu"><li class="mdui-menu-item"><a href="http://service.weibo.com/share/share.php?appkey=&title=记一个js图片上传小插件&url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/&pic=http://www.niemingzhao.top/images/favicon.jpg&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到微博</a></li><li class="mdui-menu-item"><a href="https://twitter.com/intent/tweet?text=记一个js图片上传小插件&url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/&via=聂明照" target="_blank" class="mdui-ripple">分享到Twitter</a></li><li class="mdui-menu-item"><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/" target="_blank" class="mdui-ripple">分享到Facebook</a></li><li class="mdui-menu-item"><a href="https://plus.google.com/share?url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/" target="_blank" class="mdui-ripple">分享到Google+</a></li><li class="mdui-menu-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/&title=记一个js图片上传小插件" target="_blank" class="mdui-ripple">分享到LinkedIn</a></li><li class="mdui-menu-item"><a href="http://connect.qq.com/widget/shareqq/index.html?site=聂明照的博客&title=记一个js图片上传小插件&summary=随笔、日志、技术分享、个人作品&pics=http://www.niemingzhao.top/images/favicon.jpg&url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/" target="_blank" class="mdui-ripple">分享到QQ</a></li><li class="mdui-menu-item"><a href="https://telegram.me/share/url?url=http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/&text=记一个js图片上传小插件" target="_blank" class="mdui-ripple">分享到Telegram</a></li></ul></div></header><div class="mdui-card-content mdui-typo"><p>最近在做的项目中需要一个图片上传的小控件,由于用的功能不多,索性自己写一个得了.</p><a id="more"></a><h1 id="需求分析">需求分析</h1><pre><code>我需要做一个能选择图片文件,进行预览,还能删除图片,选择查看图片大图.
</code></pre><h1 id="html文档结构">html文档结构</h1><p>由js生成</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"big_img_wrap"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"bigImg"</span> <span class="attr">class</span>=<span class="string">"big_img"</span> <span class="attr">src</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 浏览大图 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"height:10px;width:100%;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"selPhotoList"</span> <span class="attr">class</span>=<span class="string">"selphoto_list"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 选择的照片列表 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"thumb_wrp"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 缩略图 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"photo_input_wrp"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 选择框 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"photo_input_hline"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 选择框中间的横线 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"photo_input_vline"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 选择框中间的竖线 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">class</span>=<span class="string">"photo_input"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">accept</span>=<span class="string">"image/*"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 存放选择的文件 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 存放文件名 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="css样式">css样式</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type="text/css"&gt;</span><br><span class="line">  <span class="selector-class">.big_img_wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.big_img</span> &#123;</span><br><span class="line">   <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.thumb_wrp</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">77px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">77px</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input_wrp</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid gray;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input_wrp</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input_hline</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">25%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input_vline</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">25%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input_hline</span>,</span><br><span class="line">  <span class="selector-class">.photo_input_vline</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#C7C7C6</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_input</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.thumb_img</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: white;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.del_img_btn</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-8px, -8px);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">color</span>: blue;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid gray;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: blue;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h1 id="js动态生成">js动态生成</h1><p>首先引入jquery,查看效果点击 <a href="javascript:;" id="toDemo" target="_blank" rel="noopener">点击这里</a><br>在提交表单时,<br>选择的图片为:name=“photo[i]”,对应的图片名为:name=“photoNames[i]”,i 是图片的添加顺序</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> selectPhotoArea = <span class="keyword">new</span> PhotoSelect($(<span class="string">"#selectPhotoArea"</span>));</span><br><span class="line"><span class="comment">//创建图片选择区域</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">PhotoSelect</span>(<span class="params">photoSelectArea</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> photoNumMax = <span class="number">4</span>;<span class="comment">//设置最多选择的图片数</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">this</span>.checkPhoto=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> photoLength = $(<span class="string">".thumb_wrp"</span>).length;</span><br><span class="line">		<span class="keyword">if</span>((photoLength<span class="number">-1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">			alert(<span class="string">"请选择图片!"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	init();</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> html = <span class="string">""</span>;</span><br><span class="line">		html += <span class="string">'&lt;div class="big_img_wrap"&gt;'</span>+</span><br><span class="line">					<span class="string">'&lt;img id="bigImg" alt="请选择图片" class="big_img" src="" /&gt;'</span>+</span><br><span class="line">				<span class="string">'&lt;/div&gt;'</span>+</span><br><span class="line">				<span class="string">'&lt;div style="height:10px;width:100%;"&gt;&lt;/div&gt;'</span>+</span><br><span class="line">				<span class="string">'&lt;div id="selPhotoList" class="selphoto_list"&gt;'</span>+</span><br><span class="line">				<span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">		$(photoSelectArea).append(html);</span><br><span class="line">		</span><br><span class="line">		createThumbWrp();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">createThumbWrp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> html = <span class="string">""</span>;</span><br><span class="line">		html +=</span><br><span class="line">			<span class="string">'&lt;div class="thumb_wrp"&gt;'</span> +</span><br><span class="line">				<span class="string">'&lt;div class="photo_input_wrp"&gt;'</span> +</span><br><span class="line">					<span class="string">'&lt;div class="photo_input_hline"&gt;&lt;/div&gt;'</span> +</span><br><span class="line">					<span class="string">'&lt;div class="photo_input_vline"&gt;&lt;/div&gt;'</span> +</span><br><span class="line">					<span class="string">'&lt;input name="" type="file" class="photo_input" value="" accept="image/*" /&gt;'</span> +</span><br><span class="line">					<span class="string">'&lt;input name="" type="hidden" value="" /&gt;'</span> +</span><br><span class="line">				<span class="string">'&lt;/div&gt;'</span> +</span><br><span class="line">			<span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">		$(<span class="string">"#selPhotoList"</span>).append(html);</span><br><span class="line">		$(<span class="string">"#selPhotoList .photo_input:last"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> photoLength = $(<span class="string">".thumb_wrp"</span>).length;</span><br><span class="line">			<span class="keyword">if</span>(photoLength &gt; photoNumMax) &#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		$(<span class="string">"#selPhotoList .photo_input:last"</span>).on(<span class="string">"change"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">			selPhoto(<span class="keyword">this</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">previewPhoto</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> html = <span class="string">''</span>;</span><br><span class="line">		<span class="keyword">var</span> src = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">var</span> file = el.files[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">		reader.onloadend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			src = reader.result;</span><br><span class="line">			html += <span class="string">'&lt;img class="thumb_img" src="'</span> + src + <span class="string">'" /&gt;'</span>;</span><br><span class="line">			html += <span class="string">'&lt;div class="del_img_btn"&gt;×&lt;/div&gt;'</span>;</span><br><span class="line">			$(el).parent().parent().append(html);</span><br><span class="line">			$(el).siblings(<span class="string">"input[type=hidden]"</span>).val(el.value);</span><br><span class="line">			$(el).parent().parent().find(<span class="string">".thumb_img"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">				setCurrentPhoto(<span class="keyword">this</span>);</span><br><span class="line">			&#125;);</span><br><span class="line">			$(el).parent().parent().find(<span class="string">".del_img_btn"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">				delPhoto(<span class="keyword">this</span>);</span><br><span class="line">			&#125;);</span><br><span class="line">			setCurrentPhoto($(el).parent().siblings(<span class="string">".thumb_img"</span>)[<span class="number">0</span>]);</span><br><span class="line">			refreshPhotoName();</span><br><span class="line">			refreshMsg();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(file) &#123;</span><br><span class="line">			reader.readAsDataURL(file);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			src = <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">setCurrentPhoto</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(el) &#123;</span><br><span class="line">			<span class="keyword">var</span> el = $(el);</span><br><span class="line">			<span class="keyword">var</span> src = el.attr(<span class="string">"src"</span>);</span><br><span class="line">			$(<span class="string">"#bigImg"</span>).attr(<span class="string">"src"</span>, src);</span><br><span class="line">			$(<span class="string">".thumb_img"</span>).css(<span class="string">"border"</span>, <span class="string">"1px solid black"</span>);</span><br><span class="line">			el.css(<span class="string">"border"</span>, <span class="string">"1px solid red"</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$(<span class="string">"#bigImg"</span>).attr(<span class="string">"src"</span>, <span class="string">""</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">refreshPhotoName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		$(<span class="string">"#selPhotoList"</span>).find(<span class="string">"input[type=file]"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> photoUrl = $(<span class="keyword">this</span>).val();</span><br><span class="line">			<span class="keyword">if</span>(photoUrl) &#123;</span><br><span class="line">				$(<span class="keyword">this</span>).attr(<span class="string">"name"</span>, <span class="string">"photos["</span> + index + <span class="string">"]"</span>);</span><br><span class="line">				$(<span class="keyword">this</span>).next(<span class="string">"input[type=hidden]"</span>).attr(<span class="string">"name"</span>, <span class="string">"photoNames["</span> + index + <span class="string">"]"</span>);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				$(<span class="keyword">this</span>).attr(<span class="string">"name"</span>, <span class="string">""</span>);</span><br><span class="line">				$(<span class="keyword">this</span>).next(<span class="string">"input[type=hidden]"</span>).attr(<span class="string">"name"</span>, <span class="string">""</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">refreshMsg</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> photoLength = $(<span class="string">".thumb_wrp"</span>).length;</span><br><span class="line">		<span class="keyword">var</span> html = (photoLength - <span class="number">1</span>) + <span class="string">"/"</span> + photoNumMax;</span><br><span class="line">		$(<span class="string">"#selphoto_message"</span>).html(html);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">delPhoto</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">		$(el).parent().remove();</span><br><span class="line">		<span class="keyword">var</span> thumbs = $(<span class="string">".thumb_wrp"</span>);</span><br><span class="line">		<span class="keyword">var</span> len = thumbs.length;</span><br><span class="line">		setCurrentPhoto($(<span class="string">".thumb_img"</span>)[<span class="number">0</span>]);</span><br><span class="line">		refreshPhotoName();</span><br><span class="line">		refreshMsg();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">selPhoto</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> photoUrl = el.value;</span><br><span class="line">		<span class="keyword">var</span> photoLength = $(<span class="string">".thumb_wrp"</span>).length;</span><br><span class="line">		<span class="keyword">if</span>(!photoUrl) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(photoLength &gt; photoNumMax) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		previewPhoto(el);</span><br><span class="line">		createThumbWrp();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><style type="text/css">.big_img_wrap{width:500px;min-height:100px;border:1px solid #000}.big_img{width:100%}.thumb_wrp{position:relative;width:77px;height:77px;float:left;margin-right:10px}.photo_input_wrp{position:absolute;width:100%;height:100%;opacity:.5;border:1px solid gray}.photo_input_wrp:active{opacity:1}.photo_input_hline{width:50%;height:2px;top:50%;left:25%}.photo_input_vline{width:2px;height:50%;top:25%;left:50%}.photo_input_hline,.photo_input_vline{position:absolute;background-color:#c7c7c6}.photo_input{position:absolute;width:100%;height:100%;opacity:0}.thumb_img{position:absolute;border:1px solid #000;width:100%;height:100%;background-color:#fff}.del_img_btn{position:absolute;top:0;left:100%;transform:translate(-8px,-8px);width:16px;height:16px;z-index:1;color:#00f;line-height:16px;text-align:center;font-weight:700;border:1px solid gray;border-radius:50%;background:#00f;color:#fff;opacity:.8}</style><script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script><script type="text/javascript">$(document).ready(function() {
				$("#toDemo").on("click", function(e) {
					var e = e || window.event;
					floateWindow(e,"","js选择图片",-200,10);
					var selectPhotoArea = new PhotoSelect($("#floatWindowContent"));
				});
			});

/**
			 * 创建浮动窗口
			 * @param e 事件
			 * @param content 要显示的内容
			 * @param title 标题
			 * @param widthOffset  窗口出现位置的水平偏移量 负数向左偏移,默认值为-300
			 * @param heightOffset 窗口出现位置的竖直偏移量 负数向上偏移,默认值为30
			 */
			function floateWindow(e, content, title, widthOffset, heightOffset) {
				var floatWindow = $("#floatWindow");

				if(floatWindow.length === 0) { //首次执行时生成
					var floatWindowHtml =
						'<div id="floatWindow" style="position: absolute;top:400px;border-radius: 6px;background-color: #fbfbfb;' +
						'border: 1px solid rgba(240, 240, 240,0.8);box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);">' +
						'<style type="text/css">' +
						'#closeFloateWindow img{transition: transform 300ms;}' +
						'#closeFloateWindow img:hover{transform: rotate(360deg);}</style>' +
<pre><code>					'&lt;div id=&quot;floatWindowTiltle&quot; style=&quot;height:30px;width:100%;background-color:#F4F4F4;font-weight: bolder;font-size: 14px;line-height: 30px;padding-left:10px;&quot;&gt;&lt;/div&gt;' +
					'&lt;div id=&quot;closeFloateWindow&quot; style=&quot;position:absolute;right:5px;top:5px;width:15px;height:15px;font-weight:bold;cursor: pointer;font-size:20px;&quot;&gt;' +
					'&lt;img alt=&quot;关闭&quot; src=&quot;data:image/gif;base64,R0lGODlhDgAOAMQAAE2QzaHE5bnT6/H2+1CSznir2ajJ56XH5rzV7KrK506RzbvU7Hut2qnJ56XH5/H3+7/X7QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEHAA8ALAAAAAAOAA4AAAVN4DMsT2mWyCAyxHGWBlEMEGG7pqEohPDoPFzC1srZFIHY7TU87nAvHWAaeOUUU0DV2iTsFFDYMUmEAouPrqu2vPIEA1ZYPBORrI/UIwQAOw==&quot;/&gt;&lt;/div&gt;' +
					'&lt;div id=&quot;floatWindowContent&quot; style=&quot;padding:5px;&quot;&gt;&lt;/div&gt;' +
					'&lt;/div&gt;';
				$(&quot;body&quot;).append(floatWindowHtml);

				$(&quot;#closeFloateWindow&quot;).on(&quot;click&quot;, function() {
					$(&quot;#floatWindow&quot;).hide();
				});
				floatWindow = $(&quot;#floatWindow&quot;);
			}
			
			widthOffset = widthOffset || -300;
			heightOffset = heightOffset || 30;
			var left = e.pageX + widthOffset;
			var top = e.pageY + heightOffset;
			floatWindow.css({
				&quot;left&quot;: left + &quot;px&quot;,
				&quot;top&quot;: top + &quot;px&quot;
			}).show();
			$(&quot;#floatWindowContent&quot;).html(content);
			$(&quot;#floatWindowTiltle&quot;).html(title);
		}
</code></pre>
<p>//创建图片选择区域<br>
function PhotoSelect(photoSelectArea) {<br>
var photoNumMax = 4;//设置最多选择的图片数</p>
<pre><code>	this.checkPhoto=function(){
		var photoLength = $(&quot;.thumb_wrp&quot;).length;
		if((photoLength-1) == 0){
			alert(&quot;请选择图片!&quot;);
			return false;
		}
		return true;
	}
	
	init();
	function init(){
		var html = &quot;&quot;;
		html += '&lt;div class=&quot;big_img_wrap&quot;&gt;'+
					'&lt;img id=&quot;bigImg&quot; alt=&quot;请选择图片&quot; class=&quot;big_img&quot; src=&quot;&quot; /&gt;'+
				'&lt;/div&gt;'+
				'&lt;div style=&quot;height:10px;width:100%;&quot;&gt;&lt;/div&gt;'+
				'&lt;div id=&quot;selPhotoList&quot; class=&quot;selphoto_list&quot;&gt;'+
				'&lt;/div&gt;';
		$(photoSelectArea).append(html);
		
		createThumbWrp();
	}
	
	function createThumbWrp() {
		var html = &quot;&quot;;
		html +=
			'&lt;div class=&quot;thumb_wrp&quot;&gt;' +
				'&lt;div class=&quot;photo_input_wrp&quot;&gt;' +
					'&lt;div class=&quot;photo_input_hline&quot;&gt;&lt;/div&gt;' +
					'&lt;div class=&quot;photo_input_vline&quot;&gt;&lt;/div&gt;' +
					'&lt;input name=&quot;&quot; type=&quot;file&quot; class=&quot;photo_input&quot; value=&quot;&quot; accept=&quot;image/*&quot; /&gt;' +
					'&lt;input name=&quot;&quot; type=&quot;hidden&quot; value=&quot;&quot; /&gt;' +
				'&lt;/div&gt;' +
			'&lt;/div&gt;';
		$(&quot;#selPhotoList&quot;).append(html);
		$(&quot;#selPhotoList .photo_input:last&quot;).on(&quot;click&quot;, function(e) {
			var photoLength = $(&quot;.thumb_wrp&quot;).length;
			if(photoLength &gt; photoNumMax) {
				e.preventDefault();
				return false;
			}
		});
		$(&quot;#selPhotoList .photo_input:last&quot;).on(&quot;change&quot;, function(e) {
			selPhoto(this);
		});
	}
	
	function previewPhoto(el) {
		var html = '';
		var src = &quot;&quot;;
		var file = el.files[0];
		var reader = new FileReader();
		reader.onloadend = function() {
			src = reader.result;
			html += '&lt;img class=&quot;thumb_img&quot; src=&quot;' + src + '&quot; /&gt;';
			html += '&lt;div class=&quot;del_img_btn&quot;&gt;×&lt;/div&gt;';
			$(el).parent().parent().append(html);
			$(el).siblings(&quot;input[type=hidden]&quot;).val(el.value);
			$(el).parent().parent().find(&quot;.thumb_img&quot;).on(&quot;click&quot;, function(e) {
				setCurrentPhoto(this);
			});
			$(el).parent().parent().find(&quot;.del_img_btn&quot;).on(&quot;click&quot;, function(e) {
				delPhoto(this);
			});
			setCurrentPhoto($(el).parent().siblings(&quot;.thumb_img&quot;)[0]);
			refreshPhotoName();
			refreshMsg();
		}
		if(file) {
			reader.readAsDataURL(file);
		} else {
			src = &quot;&quot;;
		}
	}

	function setCurrentPhoto(el) {
		if(el) {
			var el = $(el);
			var src = el.attr(&quot;src&quot;);
			$(&quot;#bigImg&quot;).attr(&quot;src&quot;, src);
			$(&quot;.thumb_img&quot;).css(&quot;border&quot;, &quot;1px solid black&quot;);
			el.css(&quot;border&quot;, &quot;1px solid red&quot;);
		} else {
			$(&quot;#bigImg&quot;).attr(&quot;src&quot;, &quot;&quot;);
		}
	}

	function refreshPhotoName() {
		$(&quot;#selPhotoList&quot;).find(&quot;input[type=file]&quot;).each(function(index) {
			var photoUrl = $(this).val();
			if(photoUrl) {
				$(this).attr(&quot;name&quot;, &quot;photos[&quot; + index + &quot;]&quot;);
				$(this).next(&quot;input[type=hidden]&quot;).attr(&quot;name&quot;, &quot;photoNames[&quot; + index + &quot;]&quot;);
			} else {
				$(this).attr(&quot;name&quot;, &quot;&quot;);
				$(this).next(&quot;input[type=hidden]&quot;).attr(&quot;name&quot;, &quot;&quot;);
			}
		});
	}

	function refreshMsg() {
		var photoLength = $(&quot;.thumb_wrp&quot;).length;
		var html = (photoLength - 1) + &quot;/&quot; + photoNumMax;
		$(&quot;#selphoto_message&quot;).html(html);
	}

	function delPhoto(el) {
		$(el).parent().remove();
		var thumbs = $(&quot;.thumb_wrp&quot;);
		var len = thumbs.length;
		setCurrentPhoto($(&quot;.thumb_img&quot;)[0]);
		refreshPhotoName();
		refreshMsg();
	}

	function selPhoto(el) {
		var photoUrl = el.value;
		var photoLength = $(&quot;.thumb_wrp&quot;).length;
		if(!photoUrl) {
			return false;
		}
		if(photoLength &gt; photoNumMax) {
			return false;
		}
		previewPhoto(el);
		createThumbWrp();
	}
	
}
</code></pre></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css"><blockquote class="mdui-m-t-5"><strong>本文遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a> 许可协议</strong><br><strong>本文链接：</strong><a href="http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/">http://www.niemingzhao.top/2016/09/04/记一个js图片上传小插件/</a></blockquote><div class="mdui-text-center"><button class="mdui-fab mdui-color-deep-orange mdui-text-color-white mdui-ripple" mdui-dialog="{target: '#donate'}" mdui-tooltip="{content: '打赏', position: 'top'}"><i class="mdui-icon material-icons">local_cafe</i></button></div></div><footer class="mdui-card-actions"><a class="mdui-ripple article_categories-link" href="/categories/技术/">技术</a> <a class="mdui-ripple article_tags-link" href="/tags/前端/">前端</a></footer><div class="mdui-dialog" id="donate"><div class="mdui-tab mdui-tab-centered" mdui-tab><a href="#donate-0" class="mdui-ripple">支付宝</a> <a href="#donate-1" class="mdui-ripple">微信支付</a></div><div id="donate-0" class="mdui-p-a-2 mdui-typo mdui-text-center"><img src="/images/alipay.jpg" style="width:300px"></div><div id="donate-1" class="mdui-p-a-2 mdui-typo mdui-text-center"><img src="/images/wechat.jpg" style="width:300px"></div></div></article><script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#main article .mdui-card-content img.fancybox").on("click",function(c){$.fancybox.open({src:$(this).attr("src")})})</script><nav id="paginator"><a rel="prev" class="extend prev" href="/2016/10/05/Git常用命令小记/"><button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇</a><div class="spacer"></div><a rel="next" class="extend next" href="/2016/08/30/滕王阁序/">下一篇&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button></a></nav><div id="comment" class="mdui-m-t-5"><style>#feedAv,#pop_ad{display:none!important;position:absolute!important;z-index:-9999;left:-1000px;opacity:0!important}</style><div id="SOHUCS" sid="cjy4eyxzs0018jkw5wuf9u1wd"></div><script type="text/javascript">!function(){var t,e,n,a,c="cyubhC2Dq",o="prod_e4cce65003c5bed049fefcb8a6f09e12";if((window.innerWidth||document.documentElement.clientWidth)<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+c+"&conf="+o+'"><\/script>');else{t="http://changyan.sohu.com/upload/changyan.js",e=function(){window.changyan.api.config({appid:c,conf:o})},n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,(a=document.createElement("script")).setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)}}()</script></div></main><footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme"><div class="mdui-p-y-0 mdui-text-center"><a href="https://weibo.com/2360828682/profile" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xec7e;</i></a> <a href="https://github.com/niemingzhao" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe7ab;</i></a> <a href="https://www.zhihu.com/people/nie-1-58" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe6c0;</i></a> <a href="tencent://message/?uin=1432440963&Menu=yes" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe651;</i></a></div><div class="mdui-p-y-1 mdui-text-center">Copyright &copy; 2016 - 2019 聂明照<br>Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a> | 鲁ICP备19009266号-1<br><span id="busuanzi_container_site_pv" style="display:none"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_site_pv"></span></span> &nbsp;&nbsp; <span id="busuanzi_container_site_uv" style="display:none"><i class="iconfont">&#xe601;</i> <span id="busuanzi_value_site_uv"></span></span></div></footer><button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button><script async src="http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/mdui.js"></script><script src="/js/script.js"></script></body></html>